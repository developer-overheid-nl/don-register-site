---
import { PIWIK_PRO_ACCOUNT_ADDRESS, PIWIK_PRO_SITE_ID } from "astro:env/server";
import { PiwikPro } from "@developer-overheid-nl/don-register-components/analytics";
import { DonBasic } from "@developer-overheid-nl/don-register-layouts";
import type { MarkdownLayoutProps } from "astro";
import appConfig from "../../app.config";

export const prerender = true;

type Props = MarkdownLayoutProps<{
  title: string;
}>;

const { frontmatter, headings } = Astro.props;

/* Get the title, markdownlint will do some checkin', but TODO: check md files before commit */
const titlePage =
  frontmatter.title ||
  headings.filter((mdHeading) => mdHeading.depth === 1).shift()?.text ||
  frontmatter.url?.replace("/", " ").trim();
--- 

<DonBasic appConfig={appConfig} titlePage={titlePage}>
  <PiwikPro slot="head" client:only="react" 
    accountAddress={PIWIK_PRO_ACCOUNT_ADDRESS} 
    siteId={PIWIK_PRO_SITE_ID} 
    pageTitle={`${titlePage} | ${appConfig.title}`} />

  <div class="markdown-content utrecht-html">
    <slot />
  </div>
</DonBasic>

<style>
  .markdown-content {
    --utrecht-article-max-inline-size: 100ch;
    max-inline-size: var(--utrecht-article-max-inline-size);
  }
</style>
