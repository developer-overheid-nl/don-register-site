---
const searchParams = Astro.url.searchParams;
const page = searchParams.get("pagina");
searchParams.delete("pagina");

// `/apis?pagina=n` (old site) will redirect to the new url stucture
if (page) {
  return Astro.redirect(
    new URL(
      `../repositories/pagina/${page}?${searchParams.toString()}`,
      Astro.url,
    ),
  );
}

// `/apis` will show page one of the overview, filtered views included
return Astro.rewrite(
  new URL(`../repositories/pagina/1?${searchParams.toString()}`, Astro.url),
);
---